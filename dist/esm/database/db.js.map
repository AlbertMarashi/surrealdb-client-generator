{"version":3,"file":"db.js","sourceRoot":"","sources":["../../../src/database/db.ts"],"names":[],"mappings":"AAAA,OAAO,EAAE,OAAO,EAAE,MAAM,cAAc,CAAA;AAItC,IAAI,EAAW,CAAA;AAEf,MAAM,CAAC,MAAM,KAAK,GAAG,GAAG,EAAE;IACxB,IAAI,EAAE,EAAE;QACN,OAAO,EAAE,CAAA;KACV;IACD,MAAM,IAAI,KAAK,CAAC,6BAA6B,CAAC,CAAA;AAChD,CAAC,CAAA;AAED,MAAM,CAAC,MAAM,SAAS,GAAG,KAAK,EAAE,MAAc,EAAE,EAAE;IAChD,OAAO,CAAC,GAAG,CAAC,qBAAqB,CAAC,CAAA;IAClC,EAAE,GAAG,IAAI,OAAO,EAAE,CAAA;IAClB,MAAM,EAAE,CAAC,OAAO,CAAC,MAAM,CAAC,OAAO,EAAE;QAC/B,EAAE,EAAE,MAAM,CAAC,EAAE;QACb,EAAE,EAAE,MAAM,CAAC,EAAE;QACb,IAAI,EAAE,EAAE,IAAI,EAAE,MAAM,CAAC,QAAQ,EAAE,IAAI,EAAE,MAAM,CAAC,QAAQ,EAAE;KACvD,CAAC,CAAA;IACF,MAAM,EAAE,CAAC,GAAG,CAAC;QACX,EAAE,EAAE,MAAM,CAAC,EAAE;QACb,EAAE,EAAE,MAAM,CAAC,EAAE;KACd,CAAC,CAAA;AACJ,CAAC,CAAA;AAED,MAAM,CAAC,MAAM,iBAAiB,GAAG,KAAK,EAAE,OAAe,EAAE,EAAE;IACzD,MAAM,EAAE,GAAG,KAAK,EAAE,CAAA;IAClB,MAAM,MAAM,GAAG,MAAM,EAAE,CAAC,KAAK,CAAC,OAAO,EAAE,EAAE,CAAC,CAAA;IAC1C,OAAO,CAAC,GAAG,CAAC,oBAAoB,EAAE,IAAI,CAAC,SAAS,CAAC,MAAM,EAAE,IAAI,EAAE,CAAC,CAAC,CAAC,CAAA;AACpE,CAAC,CAAA;AAED,MAAM,CAAC,MAAM,OAAO,GAAG,KAAK,IAAI,EAAE;IAChC,EAAE,EAAE,KAAK,EAAE,CAAA;IACX,OAAO,CAAC,GAAG,CAAC,iBAAiB,CAAC,CAAA;AAChC,CAAC,CAAA","sourcesContent":["import { Surreal } from 'surrealdb.js'\n\nimport { Config } from '../config/types.js'\n\nlet db: Surreal\n\nexport const getDb = () => {\n  if (db) {\n    return db\n  }\n  throw new Error('Not connected to a database')\n}\n\nexport const connectDb = async (config: Config) => {\n  console.log('connect to database')\n  db = new Surreal()\n  await db.connect(config.surreal, {\n    ns: config.ns,\n    db: config.db,\n    auth: { user: config.username, pass: config.password },\n  })\n  await db.use({\n    ns: config.ns,\n    db: config.db,\n  })\n}\n\nexport const insertDefinitions = async (content: string) => {\n  const db = getDb()\n  const result = await db.query(content, {})\n  console.log('insertDefinitions:', JSON.stringify(result, null, 2))\n}\n\nexport const closeDb = async () => {\n  db?.close()\n  console.log('database closed')\n}\n"]}